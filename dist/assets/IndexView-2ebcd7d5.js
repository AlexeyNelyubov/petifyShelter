import{d as Q,r as i,w,u as ae,o,c as g,a as v,t as C,b as R,n as H,e as j,v as X,f as k,F as N,g as q,h as le,i as U,_ as re,j as se,k as ie,l as I,m as oe,p as ne,q as ue,s as x,R as ce,x as G,y as ve,z as ge,A as B,B as J}from"./index-bc0d0b2a.js";import{_ as pe}from"./_plugin-vue_export-helper-c27b6911.js";import{g as de,a as O,u as fe}from"./petsList-86ded779.js";const _e=Q("filters",()=>({filters:i({type:[],gender:[],breeds:[]})}));const me={class:"filter-type__header"},Fe=v("img",{src:re,width:"14",height:"8",alt:"arrow"},null,-1),he={key:0,class:"filter-type__drop-down-breed__breed"},Pe=["value"],ye=v("br",null,null,-1),V={__name:"FilterSingle",props:{itemForFilter:Object,ArrTypeFilter:{type:Array,required:!1},FiltersFromLocalStorage:{type:Object,required:!1},clearAllFilters:Boolean},emits:["change-single-filter"],setup(b,{emit:r}){const e=b,s=_e(),a=i({});let p=i(0);const u=i([]),c=i(0),f=i("Введите породу");let F=[];h("general"),e.ArrTypeFilter&&w(e.ArrTypeFilter,()=>A()),w(()=>f.value,()=>{if(A(),f.value.length){let P=JSON.parse(JSON.stringify(a.value)),m=[];for(let n in P){a.value[n].splice(0);for(let $ of P[n])f.value.toUpperCase()===$.substring(0,f.value.length).toUpperCase()&&(a.value[n].push($),m.includes(n)||m.push(n))}for(let n in a.value)m.includes(n)||delete a.value[n]}}),w(u,()=>{s.filters[e.itemForFilter.general[0]].splice(0),c.value=0,F=[];for(let P of u.value)F.push(P),c.value++,s.filters[e.itemForFilter.general[0]].push(P);r("change-single-filter",F,e.itemForFilter.general[0])}),w(()=>e.clearAllFilters,()=>{e.clearAllFilters&&(c.value=0,u.value.splice(0),s.filters.type.splice(0),s.filters.gender.splice(0),s.filters.breeds.splice(0),r("change-single-filter",u.value,e.itemForFilter.general[0]))}),e.FiltersFromLocalStorage&&w(e.FiltersFromLocalStorage,()=>{for(let P in e.FiltersFromLocalStorage)if(e.FiltersFromLocalStorage[P].length&&P===e.itemForFilter.general[0]){F=[];for(let m of e.FiltersFromLocalStorage[P])F.push(m);u.value=F}}),S();const L=i(!1),t=i("");e.itemForFilter.general[0]==="breeds"?t.value="Не выбрана":t.value="Не выбран",w(c,()=>{c.value===0?(t.value="Не выбран",e.itemForFilter.general[0]==="breeds"&&(t.value="Не выбрана")):c.value===p.value?t.value="Все":t.value="Выбрано "+String(c.value)});function _(){f.value==="Введите породу"&&(f.value="")}function S(){if(s.filters[e.itemForFilter.general[0]].length){for(let P in s.filters)if(P===e.itemForFilter.general[0]){F=[];for(let m of s.filters[P])F.push(m);u.value=F}}}function h(P){a.value={};for(let m in e.itemForFilter){let n=[];if(m!=P){for(let $ of e.itemForFilter[m])n.push($),p.value++;a.value[m]=n}}}function A(){if(e.ArrTypeFilter.length){a.value={};for(let P of e.ArrTypeFilter)for(let m in e.itemForFilter){let n=[];if(P===m){for(let $ of e.itemForFilter[P])n.push($);a.value[m]=n}}}else h("general")}return ae(()=>{L.value=!1}),(P,m)=>(o(),g("div",{class:H(["filter-type",{"filter-type_border-all":t.value==="Все","filter-type_border":t.value!="Все"&&t.value!="Не выбран"&&t.value!="Не выбрана"&&t.value!=""}])},[v("p",me,C(e.itemForFilter.general[1]),1),v("div",{class:"filter-type__field-for-count-filters",onClick:m[0]||(m[0]=R(n=>L.value=!L.value,["stop"]))},[v("p",null,C(t.value),1),Fe]),L.value?(o(),g("div",{key:0,class:H({"filter-type__drop-down":e.itemForFilter.general[0]!="breeds","filter-type__drop-down-breed":e.itemForFilter.general[0]==="breeds"}),onClick:m[3]||(m[3]=R(()=>{},["stop"]))},[e.itemForFilter.general[0]==="breeds"?j((o(),g("input",{key:0,type:"text","onUpdate:modelValue":m[1]||(m[1]=n=>f.value=n),onFocus:_,class:"filter-type__drop-down-breed__input"},null,544)),[[X,f.value]]):k("",!0),(o(!0),g(N,null,q(a.value,(n,$)=>(o(),g("div",{key:$.id},[e.itemForFilter.general[0]==="breeds"?(o(),g("div",he,C($),1)):k("",!0),(o(!0),g(N,null,q(a.value[$],z=>(o(),g("label",{key:z.id,class:"filter-type__drop-down-label"},[j(v("input",{type:"checkbox",value:z,"onUpdate:modelValue":m[2]||(m[2]=T=>u.value=T)},null,8,Pe),[[le,u.value]]),U(" "+C(z)+" ",1),ye]))),128))]))),128))],2)):k("",!0)],2))}},Y=Q("pagination",()=>({pagination:i("")}));const Se={class:"pagination"},ke={key:0,class:"pagination__prompt"},be=v("p",{class:"pagination__header"},"Показывать",-1),Le={class:"pagination-input"},$e={__name:"FilterPagination",props:{PaginationFromLocalStorage:String},emits:["pagination"],setup(b,{emit:r}){const e=b,s=Y(),a=i("Всех"),p=i(!1),u=i(!1),c=i("");a.value==="Всех"&&t(),s.pagination&&(a.value=s.pagination,r("pagination",a.value)),w(()=>e.PaginationFromLocalStorage,()=>{a.value=e.PaginationFromLocalStorage,s.pagination=e.PaginationFromLocalStorage,r("pagination",a.value)});function f(){a.value==="Всех"&&(a.value="",s.pagination=""),p.value=!0,u.value=!0}function F(){a.value===""&&(a.value="Всех",s.pagination="Всех"),a.value>0&&a.value<31?(s.pagination=a.value,localStorage.setItem("pagination",a.value),r("pagination",a.value)):(localStorage.removeItem("pagination",a.value),a.value="Всех",s.pagination="Всех",r("pagination",a.value)),p.value=!1,u.value=!1}function L(){u.value||(p.value=!1)}w(()=>a.value,()=>{t()});function t(){a.value>=1&&a.value<=4?c.value="питомца":c.value="питомцев"}return se(()=>{document.addEventListener("keyup",_=>{let S=document.querySelector(".pagination-input__input");_.key==="Enter"&&p.value&&S.blur()})}),ie(()=>{document.removeEventListener("keyup",_=>{let S=document.querySelector(".pagination-input__input");_.key==="Enter"&&p.value&&S.blur()})}),(_,S)=>(o(),g("div",Se,[p.value?(o(),g("p",ke," Укажите сколько питомцев отображать на странице ")):k("",!0),be,v("div",Le,[j(v("input",{onPointerover:S[0]||(S[0]=h=>p.value=!0),onPointerleave:L,onBlur:F,onFocus:f,"onUpdate:modelValue":S[1]||(S[1]=h=>a.value=h),class:"pagination-input__input"},null,544),[[X,a.value]]),v("p",null,C(c.value),1)])]))}};const we={class:"filters"},Ce={class:"filters__filters"},Ae={class:"filters__lucky-pagination"},xe={__name:"FeedFilters",props:{FiltersFromLocalStorage:{type:Object,required:!1},PaginationFromLocalStorage:String,PetsListForShow:{type:Array,required:!0}},emits:["change-filter","pagination"],setup(b,{emit:r}){const e=b,s=i(!1),a={general:["type","Вид животного"],filters:["Кот","Собака","Птица"]},p={general:["gender","Пол"],filters:["Мальчик","Девочка"]},u={general:["breeds","Порода"],Коты:["Беспородная","Британская длинношёрстная","Сибирская","Американская короткошёрстная","Персидская","Турецкий ван"],Собаки:["Беспородная","Автралийский келпи","Австралийская овчарка","Бернский зенненхунд","Лабрадор","Ретривер","Хаски","Лайка"],Птицы:["Волнистый","Розелла","Корелла"]},c=i([]);function f(t,_){if(s.value=!1,_==="type"){c.value.splice(0);for(let S of t)switch(S){case"Кот":c.value.push("Коты");break;case"Собака":c.value.push("Собаки");break;case"Птица":c.value.push("Птицы");break}}r("change-filter",t,_)}function F(t){r("pagination",t)}function L(){let t=e.PetsListForShow[Math.floor(Math.random()*e.PetsListForShow.length)];oe.push({name:"PetPage",params:{id:`${t.id}`}})}return(t,_)=>(o(),g("div",we,[v("div",Ce,[I(V,{onChangeSingleFilter:f,itemForFilter:a,FiltersFromLocalStorage:e.FiltersFromLocalStorage,clearAllFilters:s.value},null,8,["FiltersFromLocalStorage","clearAllFilters"]),I(V,{onChangeSingleFilter:f,itemForFilter:p,FiltersFromLocalStorage:e.FiltersFromLocalStorage,clearAllFilters:s.value},null,8,["FiltersFromLocalStorage","clearAllFilters"]),I(V,{onChangeSingleFilter:f,itemForFilter:u,ArrTypeFilter:c.value,FiltersFromLocalStorage:e.FiltersFromLocalStorage,clearAllFilters:s.value},null,8,["ArrTypeFilter","FiltersFromLocalStorage","clearAllFilters"]),v("button",{class:"filters__btn-clear-all-filters",onClick:_[0]||(_[0]=S=>s.value=!0)}," Сбросить фильтры ")]),v("div",Ae,[v("button",{class:"filters__btn-lucky",onClick:L}," Мне повезёт "),I($e,{class:"filters__pagination",onPagination:F,PaginationFromLocalStorage:e.PaginationFromLocalStorage},null,8,["PaginationFromLocalStorage"])])]))}},Ie=pe(xe,[["__scopeId","data-v-2cd3ad82"]]),Ne="/petifyShelter/assets/star-fc695a82.svg",Te="/petifyShelter/assets/vaccinated-8e2611da.svg";const qe={class:"pet-card"},ze={class:"pet-card__field-for-avatar"},Be=["src"],Me={class:"pet-card__discription"},Ge={class:"pet-card__type-name-age"},Oe=["src"],Ve={class:"pet-card__name-age"},je={class:"pet-card__name-age__name"},Ue={class:"pet-card__name-age__age"},Ee={class:"pet-card__sterilized-vaccinated-gender"},De={class:"pet-card__sterilized-gender"},Re={key:0,src:Te},He=["src"],Je={class:"pet-card__features"},W={__name:"FeedPetsCards",props:{pet:Object},setup(b){const r=b,e=ne(),s=i(""),a=de(r.pet.age),p=i(""),u=i(""),c=i(!1),f=i(!0);switch(r.pet.type){case"Кот":s.value="src/assets//images/Feed/cat.svg";break;case"Собака":s.value="src/assets//images/Feed/dog.svg";break;case"Птица":s.value="src/assets//images/Feed/dog.svg";break}r.pet.gender==="Мальчик"?(u.value="src/assets//images/Feed/male.svg",r.pet.sterilized?p.value="стерелизован":p.value="не стерелизован"):(u.value="src/assets//images/Feed/female.svg",r.pet.sterilized?p.value="стерелизована":p.value="не стерелизована");const F=()=>{e.authentificated||(f.value=!1)};return(L,t)=>(o(),g("div",qe,[v("img",{onClick:F,class:"pet-card__field-for-avatar__imgStar",src:Ne,alt:"imgstar",width:"23"}),v("div",ze,[I(x(ce),{to:{name:"PetPage",params:{id:`${r.pet._id}`}}},{default:ue(()=>[v("img",{src:r.pet.avatar,class:"pet-card__avatar"},null,8,Be)]),_:1},8,["to"])]),v("div",Me,[v("div",Ge,[v("img",{src:s.value},null,8,Oe),v("div",Ve,[v("p",je,C(r.pet.name),1),v("p",Ue,C(x(a)),1)])]),v("div",Ee,[v("div",De,[v("p",{class:"pet-card__sterilized-gender__sterilized",style:G({backgroundColor:x(O)()})},C(p.value),5),r.pet.vaccinated?(o(),g("img",Re)):k("",!0),v("img",{src:u.value,class:"pet-card__sterilized-gender__gender"},null,8,He)]),v("div",Je,[v("p",{class:"pet-card__single-feature",style:G({backgroundColor:x(O)()})},C(r.pet.features[0]),5),r.pet.features[1]?(o(),g("p",{key:0,class:"pet-card__single-feature",onPointerover:t[0]||(t[0]=_=>c.value=!0),style:G({backgroundColor:x(O)(),fontWeight:"bold"})}," ... ",36)):k("",!0)]),c.value?(o(),g("div",{key:0,class:"pet-card__all-features",onPointerover:t[1]||(t[1]=_=>c.value=!0),onPointerleave:t[2]||(t[2]=_=>c.value=!1)},[(o(!0),g(N,null,q(r.pet.features,_=>(o(),g("div",{key:_.id,class:"pet-card__single-feature-in-all-features",style:G({backgroundColor:x(O)()})},C(_),5))),128))],32)):k("",!0),f.value?k("",!0):(o(),g("div",{key:1,class:"pet-card__all-features",onPointerleave:t[3]||(t[3]=_=>f.value=!0)}," Для добавления карточки в закладки необходимо зарегистрироваться ",32))])])]))}};const We={class:"feed-pets-cards-pagination__pagination"},Ke=["onClick"],K={__name:"FeedPagination",props:{lastPage:{type:Number,required:!0},currentPage:{type:Number,required:!0}},emits:["change-page"],setup(b){const r=b,e=i([]),s=i(1),a=i(10);p(1),w(()=>r.lastPage,()=>{e.value.splice(0),p(1)}),w(()=>r.currentPage,()=>{e.value.splice(0),p(r.currentPage)});function p(u){u>=6?u+5<=r.lastPage?(s.value=u-4,a.value=u+5):(s.value=r.lastPage-10,a.value=r.lastPage):(s.value=1,a.value=10),r.lastPage<=10&&(s.value=1,a.value=r.lastPage);for(let c=s.value;c<=a.value;c++)c!=u?e.value.push(c):e.value.push("_")}return(u,c)=>(o(),g("div",We,[U(" [ "),(o(!0),g(N,null,q(e.value,f=>(o(),g("div",{key:f.id},[v("p",{onClick:F=>u.$emit("change-page",`${f}`),class:"feed-pets-cards-pagination__page"}," -"+C(f),9,Ke)]))),128)),U(" -] ")]))}},Qe="/petifyShelter/assets/arrow-left-1e8dfb63.svg",Xe="/petifyShelter/assets/arrow-right-b59ef075.svg";const Ye={__name:"FeedPaginationArrow",props:{counterPagination:{type:Number,required:!0},lastPage:{type:Number,required:!0},currentPage:{type:Number,required:!0}},emits:["change-page-arrow-minus","change-page-arrow-plus"],setup(b){const r=b;return(e,s)=>(o(),g(N,null,[r.counterPagination&&r.currentPage>1?(o(),g("img",{key:0,src:Qe,alt:"arrow-left",class:"feed-arrow-left",onClick:s[0]||(s[0]=a=>e.$emit("change-page-arrow-minus"))})):k("",!0),r.counterPagination&&r.currentPage>=1&&r.currentPage<r.lastPage?(o(),g("img",{key:1,src:Xe,alt:"arrow-left",class:"feed-arrow-right",onClick:s[1]||(s[1]=a=>e.$emit("change-page-arrow-plus"))})):k("",!0)],64))}};const Ze={key:4,class:"feed-pets-cards"},et={key:5,class:"feed-pets-cards-pagination"},tt={class:"feed-pets-cards-pagination__pets-cards"},at={__name:"TheFeed",setup(b){const r=fe(),e=ve(),s=Y(),a=i(""),p=i([]),u=i({type:[],gender:[],breeds:[]}),c=i(),f=i([]),F=i([]),L=i([]),t=i([]),_=i([]),S=i(!1),h=i(0),A=i({type:[],gender:[],breeds:[]});let P=[];const m=i(""),n=i(1),$=ge(()=>Math.ceil(t.value.length/h.value));function z(l,d){if(A.value[d].splice(0),l.length)for(let y of l)A.value[d].push(y),localStorage.setItem(d,l);else localStorage.removeItem(d)}function T(){if(s.pagination&&!h.value&&(h.value=s.pagination==="Всех"?0:Number(s.pagination)),L.value.splice(0),h.value>=t.value.length&&(h.value=0),h.value){n.value=1;for(let l=0;l<=h.value-1;l++)L.value.push(t.value[l])}}w(()=>n.value,()=>{if(n.value<1&&(n.value=1),n.value<=$.value){L.value.splice(0);for(let l=n.value*h.value-h.value;l<=n.value*h.value-1&&t.value[l];l++)L.value.push(t.value[l])}});function Z(l){l==="Всех"?h.value=0:h.value=Number(l),T()}function ee(){if(localStorage.getItem("type"))for(let l of localStorage.getItem("type").split(","))u.value.type.push(l);if(localStorage.getItem("gender"))for(let l of localStorage.getItem("gender").split(","))u.value.gender.push(l);if(localStorage.getItem("breeds"))for(let l of localStorage.getItem("breeds").split(","))u.value.breeds.push(l);localStorage.getItem("geolocation")?e.location=localStorage.getItem("geolocation"):e.location="Весь мир",localStorage.getItem("pagination")&&(c.value=localStorage.getItem("pagination"))}if(r.petsList.length){p.value.splice(0),t.value.splice(0);for(let l of r.petsList)p.value.push(l),t.value.push(l);D()}else(async()=>{try{let l=await fetch("https://petify-shelter-back.onrender.com/api/v1/pets"),d=await l.json();if(l.ok){for(let y of d)p.value.push(y),t.value.push(y),r.petsList.push(y);ee()}else console.log(d),a.value="Сервер не отвечает! Перезагрузите страницу и попробуйте ещё раз."}catch(l){console.error(l),a.value="Сервер не отвечает! Перезагрузите страницу и попробуйте ещё раз."}})();w(()=>e.location,()=>{D(),M(),_.value.length||T()}),w(A.value,()=>{P=p.value.slice(0);for(let l in A.value)if(A.value[l].length){t.value.splice(0),F.value.splice(0),_.value.includes(l)||_.value.push(l);for(let d of P)for(let y of A.value[l]){if(d[l].length)for(let te of d[l])y===te&&(t.value.includes(d)||(t.value.push(d),F.value.push(d)));y===d[l]&&(t.value.push(d),F.value.push(d))}P=t.value.slice(0)}else for(let d in _.value)_.value[d]===l&&_.value.splice(d,1);if(!_.value.length){t.value.splice(0),F.value.splice(0);for(let l of p.value)t.value.push(l),F.value.push(l)}S.value?E():(M(),T())});function E(){t.value.splice(0);for(let l of f.value)for(let d of F.value)d.id===l.id&&t.value.push(l);M(),T()}function M(){t.value.length?m.value="":m.value="По вашему запросу животных не найдено. Попробуйте изменить фильтры."}function D(){if(e.location==="Весь мир"){S.value=!1,t.value.splice(0),f.value.splice(0);for(let l of p.value)f.value.push(l),t.value.push(l)}else if(e.location!=""){t.value.splice(0),f.value.splice(0);for(let l of p.value)e.location===l.shelter.address&&(f.value.push(l),t.value.push(l));S.value=!0}_.value.length?E():S.value&&M()}return(l,d)=>(o(),g("div",null,[a.value?(o(),B(J,{key:0,message:a.value},null,8,["message"])):k("",!0),a.value?k("",!0):(o(),B(Ye,{key:1,counterPagination:h.value,lastPage:x($),currentPage:n.value,onChangePageArrowMinus:d[0]||(d[0]=y=>n.value--),onChangePageArrowPlus:d[1]||(d[1]=y=>n.value++)},null,8,["counterPagination","lastPage","currentPage"])),a.value?k("",!0):(o(),B(Ie,{key:2,class:"feed-filters",onChangeFilter:z,onPagination:Z,FiltersFromLocalStorage:u.value,PaginationFromLocalStorage:c.value,PetsListForShow:t.value},null,8,["FiltersFromLocalStorage","PaginationFromLocalStorage","PetsListForShow"])),m.value?(o(),B(J,{key:3,message:m.value},null,8,["message"])):k("",!0),!h.value&&!a.value?(o(),g("div",Ze,[(o(!0),g(N,null,q(t.value,y=>(o(),g("div",{key:y.id},[I(W,{pet:y},null,8,["pet"])]))),128))])):k("",!0),h.value&&!a.value?(o(),g("div",et,[I(K,{lastPage:x($),currentPage:n.value,onChangePage:d[2]||(d[2]=y=>n.value=Number(y))},null,8,["lastPage","currentPage"]),v("div",tt,[(o(!0),g(N,null,q(L.value,y=>(o(),g("div",{key:y.id},[I(W,{pet:y},null,8,["pet"])]))),128))]),I(K,{counterPagination:h.value,lastPage:x($),currentPage:n.value,onChangePage:d[3]||(d[3]=y=>n.value=Number(y))},null,8,["counterPagination","lastPage","currentPage"])])):k("",!0)]))}},it={__name:"IndexView",setup(b){return(r,e)=>(o(),B(at))}};export{it as default};
